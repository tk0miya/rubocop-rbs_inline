# Generated from lib/rubocop/cop/style/rbs_inline/missing_type_annotation.rb with RBS::Inline

module RuboCop
  module Cop
    module Style
      module RbsInline
        # Checks that method definitions and `attr_*` declarations have
        # RBS inline type annotations.
        #
        # The `EnforcedStyle` option determines which annotation format is required:
        #
        # - `method_type_signature`: Requires `#:` annotation comments only
        # - `doc_style`: Requires `# @rbs` annotations
        # - `doc_style_and_return_annotation`: Requires `# @rbs` parameters and trailing `#:` return type
        #
        # The `Visibility` option determines which methods to check:
        #
        # - `all`: Checks all methods regardless of visibility (default)
        # - `public`: Only checks public methods and `attr_*` declarations
        #
        # Methods annotated with `# @rbs skip` are always excluded from inspection.
        #
        # @example EnforcedStyle: method_type_signature
        #   # bad
        #   def greet(name)
        #     "Hello, #{name}"
        #   end
        #
        #   # bad
        #   attr_reader :name
        #
        #   # good
        #   #: (String) -> String
        #   def greet(name)
        #     "Hello, #{name}"
        #   end
        #
        #   # good
        #   #: String
        #   attr_reader :name
        #
        # @example EnforcedStyle: doc_style
        #   # bad
        #   def greet(name)
        #     "Hello, #{name}"
        #   end
        #
        #   # bad
        #   attr_reader :name
        #
        #   # good
        #   # @rbs name: String
        #   # @rbs return: String
        #   def greet(name)
        #     "Hello, #{name}"
        #   end
        #
        #   # good
        #   # @rbs name: String
        #   attr_reader :name
        #
        # @example EnforcedStyle: doc_style_and_return_annotation
        #   # bad - no annotation
        #   def greet(name)
        #     "Hello, #{name}"
        #   end
        #
        #   # bad - missing trailing return type
        #   # @rbs name: String
        #   def greet(name)
        #     "Hello, #{name}"
        #   end
        #
        #   # good - @rbs parameters + trailing return type
        #   # @rbs name: String
        #   def greet(name) #: String
        #     "Hello, #{name}"
        #   end
        #
        #   # good - attr with trailing type
        #   attr_reader :name #: String
        class MissingTypeAnnotation < Base
          include CommentParser

          include ConfigurableEnforcedStyle

          include RangeHelp

          METHOD_TYPE_SIGNATURE_MESSAGE: ::String

          DOC_STYLE_PARAM_MESSAGE: ::String

          DOC_STYLE_RETURN_MESSAGE: ::String

          DOC_STYLE_TRAILING_RETURN_MESSAGE: ::String

          ATTRIBUTE_METHOD_MESSAGE: ::String

          ATTR_METHODS: untyped

          VISIBILITY_MODIFIERS: untyped

          type visibility = :public | :protected | :private

          class MethodEntry < Data
            attr_reader name(): Symbol

            attr_reader node(): Parser::AST::Node

            attr_reader visibility(): visibility

            def self.new: (Symbol name, Parser::AST::Node node, visibility visibility) -> instance
                        | (name: Symbol, node: Parser::AST::Node, visibility: visibility) -> instance

            def self.members: () -> [ :name, :node, :visibility ]

            def members: () -> [ :name, :node, :visibility ]
          end

          attr_reader visibility_stack: Array[visibility]

          attr_reader unannotated_methods_stack: Array[Array[MethodEntry]]

          def on_new_investigation: () -> void

          def on_investigation_end: () -> void

          # @rbs _node: Parser::AST::Node
          def on_class: (untyped _node) -> void

          alias on_module on_class

          alias on_sclass on_class

          # @rbs _node: Parser::AST::Node
          def after_class: (untyped _node) -> void

          alias after_module after_class

          alias after_sclass after_class

          # @rbs node: Parser::AST::Node
          def on_def: (Parser::AST::Node node) -> void

          alias on_defs on_def

          # @rbs node: Parser::AST::Node
          def on_send: (Parser::AST::Node node) -> void

          private

          # Returns the method entries for the current scope (class/module)
          def current_method_entries: () -> Array[MethodEntry]

          # @rbs node: Parser::AST::Node
          def on_visibility_modifier: (Parser::AST::Node node) -> void

          # @rbs node: Parser::AST::Node
          def on_attribute_method: (Parser::AST::Node node) -> void

          # @rbs node: Parser::AST::Node
          def current_visibility: (Parser::AST::Node node) -> visibility

          # @rbs visibility: visibility
          def target_node?: (visibility visibility) -> bool

          def check_method_entries: () -> void

          # @rbs node: Parser::AST::Node
          def check_def: (Parser::AST::Node node) -> void

          # @rbs node: Parser::AST::Node
          def check_method_type_signature: (Parser::AST::Node node) -> void

          # @rbs node: Parser::AST::Node
          def check_method_parameters_in_doc_style: (Parser::AST::Node node) -> void

          # @rbs node: Parser::AST::Node
          def check_return_type_in_doc_style: (Parser::AST::Node node) -> void

          # @rbs node: Parser::AST::Node
          def check_return_type_in_return_annotation: (Parser::AST::Node node) -> void

          # @rbs node: Parser::AST::Node
          def check_attribute_method: (Parser::AST::Node node) -> void

          # Returns the last line of the method parameter list (the closing ) line, or the def line if no parens).
          # @rbs node: Parser::AST::Node
          def method_parameter_list_end_line: (Parser::AST::Node node) -> Integer

          # @rbs node: Parser::AST::Node
          def args_node_for: (Parser::AST::Node node) -> Parser::AST::Node

          # @rbs line: Integer
          def annotated_attribute_method?: (Integer line) -> boolish

          # @rbs annotation: RBS::Inline::AST::Annotations::VarType | RBS::Inline::AST::Annotations::BlockType | RBS::Inline::AST::Annotations::SplatParamType | RBS::Inline::AST::Annotations::DoubleSplatParamType # rubocop:disable Layout/LineLength
          def doc_style_annotation_name: (RBS::Inline::AST::Annotations::VarType | RBS::Inline::AST::Annotations::BlockType | RBS::Inline::AST::Annotations::SplatParamType | RBS::Inline::AST::Annotations::DoubleSplatParamType annotation) -> String

          # @rbs line: Integer
          def skip_annotation?: (Integer line) -> bool

          # Returns acceptable annotation name variants for the parameter, or nil for unrecognized types.
          # @rbs argument: Parser::AST::Node
          # @rbs name: String
          def param_candidate_names: (Parser::AST::Node argument, String name) -> Array[String]?

          # Returns the display name for a parameter node, used in offense messages.
          # @rbs argument: Parser::AST::Node
          def param_display_name: (Parser::AST::Node argument) -> String

          # @rbs node: Parser::AST::Node
          def offense_range_for_def: (Parser::AST::Node node) -> Parser::Source::Range
        end
      end
    end
  end
end
